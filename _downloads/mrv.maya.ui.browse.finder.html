<html>
<head>
<title>mrv.maya.ui.browse.finder</title>
</head>
<body>
mrv.maya.ui.browse.finder
<style>
.coverage pre {float: left; margin: 0px 1em; border: none;
               padding: 0px; }
.num pre { margin: 0px }
.nocov, .nocov pre {background-color: #faa}
.cov, .cov pre {background-color: #cfc}
div.coverage div { clear: both; height: 1.1em}
</style>
<div class="stats">
Covered: 78 lines<br/>
Missed: 117 lines<br/>
Skipped 118 lines<br/>
Percent: 40 %<br/>

</div>
<div class="coverage">
<div class="skip"><span class="num"><pre>  1</pre></span><pre># -*- coding: utf-8 -*-</pre></div>
<div class="cov"><span class="num"><pre>  2</pre></span><pre>__docformat__ = &quot;restructuredtext&quot;</pre></div>
<div class="cov"><span class="num"><pre>  3</pre></span><pre>import mrv.maya.ui as ui</pre></div>
<div class="cov"><span class="num"><pre>  4</pre></span><pre>from mrv.maya.util import (logException,)</pre></div>
<div class="skip"><span class="num"><pre>  5</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>  6</pre></span><pre>from control import FinderElement</pre></div>
<div class="skip"><span class="num"><pre>  7</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>  8</pre></span><pre>from util import concat_url</pre></div>
<div class="skip"><span class="num"><pre>  9</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre> 10</pre></span><pre>__all__ = ('Finder', )</pre></div>
<div class="skip"><span class="num"><pre> 11</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre> 12</pre></span><pre>class Finder(ui.EventSenderUI):</pre></div>
<div class="cov"><span class="num"><pre> 13</pre></span><pre>	&quot;&quot;&quot;The Finder control implements a finder-like browser, which displays URLs.</pre></div>
<div class="cov"><span class="num"><pre> 14</pre></span><pre>	URLs consist of items separated by the &quot;/&quot; character. Whenever a item is selected, </pre></div>
<div class="cov"><span class="num"><pre> 15</pre></span><pre>	an iProvider compatible instance will be asked for the subitems of the corresponding URL. </pre></div>
<div class="cov"><span class="num"><pre> 16</pre></span><pre>	Using these, a new field will be set up for presentation.</pre></div>
<div class="cov"><span class="num"><pre> 17</pre></span><pre>	A filter can be installed to prevent items from being shown.</pre></div>
<div class="skip"><span class="num"><pre> 18</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre> 19</pre></span><pre>	An added benefit is the ability to automatically match previously selected path</pre></div>
<div class="cov"><span class="num"><pre> 20</pre></span><pre>	items on a certain level of the URL with the available ones, allowing to quickly</pre></div>
<div class="cov"><span class="num"><pre> 21</pre></span><pre>	parse through URLs with a similar structure.</pre></div>
<div class="skip"><span class="num"><pre> 22</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre> 23</pre></span><pre>	A limitation of the current implementation is, that you can only keep one</pre></div>
<div class="cov"><span class="num"><pre> 24</pre></span><pre>	item selected at once in each url item area.&quot;&quot;&quot;</pre></div>
<div class="skip"><span class="num"><pre> 25</pre></span><pre></pre></div>
<div class="skip"><span class="num"><pre> 26</pre></span><pre>	#{ Configuration</pre></div>
<div class="cov"><span class="num"><pre> 27</pre></span><pre>	t_element = FinderElement</pre></div>
<div class="skip"><span class="num"><pre> 28</pre></span><pre>	#} END configuration</pre></div>
<div class="skip"><span class="num"><pre> 29</pre></span><pre>	</pre></div>
<div class="skip"><span class="num"><pre> 30</pre></span><pre>	#{ Signals</pre></div>
<div class="skip"><span class="num"><pre> 31</pre></span><pre>	</pre></div>
<div class="skip"><span class="num"><pre> 32</pre></span><pre>	# s()</pre></div>
<div class="cov"><span class="num"><pre> 33</pre></span><pre>	selection_changed = ui.Signal()</pre></div>
<div class="skip"><span class="num"><pre> 34</pre></span><pre>	</pre></div>
<div class="skip"><span class="num"><pre> 35</pre></span><pre>	# s(url)</pre></div>
<div class="cov"><span class="num"><pre> 36</pre></span><pre>	url_changed = ui.Signal() </pre></div>
<div class="skip"><span class="num"><pre> 37</pre></span><pre>	</pre></div>
<div class="skip"><span class="num"><pre> 38</pre></span><pre>	#} END signals</pre></div>
<div class="skip"><span class="num"><pre> 39</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre> 40</pre></span><pre>	def __init__(self, provider=None, filter=None):</pre></div>
<div class="nocov"><span class="num"><pre> 41</pre></span><pre>		self._provider = None</pre></div>
<div class="nocov"><span class="num"><pre> 42</pre></span><pre>		self._filter = None</pre></div>
<div class="skip"><span class="num"><pre> 43</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre> 44</pre></span><pre>		# initialize layouts</pre></div>
<div class="nocov"><span class="num"><pre> 45</pre></span><pre>		self._form = ui.FormLayout()</pre></div>
<div class="nocov"><span class="num"><pre> 46</pre></span><pre>		self._form.setParentActive()</pre></div>
<div class="skip"><span class="num"><pre> 47</pre></span><pre>		</pre></div>
<div class="nocov"><span class="num"><pre> 48</pre></span><pre>		self.setProvider(provider)</pre></div>
<div class="nocov"><span class="num"><pre> 49</pre></span><pre>		self.setFilter(filter)</pre></div>
<div class="skip"><span class="num"><pre> 50</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre> 51</pre></span><pre>	# { Query</pre></div>
<div class="skip"><span class="num"><pre> 52</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre> 53</pre></span><pre>	def layout(self):</pre></div>
<div class="cov"><span class="num"><pre> 54</pre></span><pre>		&quot;&quot;&quot;:return: the finder's main layout which contains all controls&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre> 55</pre></span><pre>		return self._form</pre></div>
<div class="skip"><span class="num"><pre> 56</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre> 57</pre></span><pre>	def provider(self):</pre></div>
<div class="cov"><span class="num"><pre> 58</pre></span><pre>		&quot;&quot;&quot;:return: current url provider&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre> 59</pre></span><pre>		return self._provider</pre></div>
<div class="skip"><span class="num"><pre> 60</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre> 61</pre></span><pre>	def selectedUrl(self, absolute=False):</pre></div>
<div class="cov"><span class="num"><pre> 62</pre></span><pre>		&quot;&quot;&quot;:return: string representing the currently selected, / separated URL, or</pre></div>
<div class="cov"><span class="num"><pre> 63</pre></span><pre>			None if there is no url selected</pre></div>
<div class="cov"><span class="num"><pre> 64</pre></span><pre>		:param absolute: if True, an absolute URL will be provided using the provider's</pre></div>
<div class="cov"><span class="num"><pre> 65</pre></span><pre>			root&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre> 66</pre></span><pre>		items = list()</pre></div>
<div class="nocov"><span class="num"><pre> 67</pre></span><pre>		for elm in self._form.listChildren():</pre></div>
<div class="nocov"><span class="num"><pre> 68</pre></span><pre>			if not elm.p_manage:</pre></div>
<div class="nocov"><span class="num"><pre> 69</pre></span><pre>				break</pre></div>
<div class="nocov"><span class="num"><pre> 70</pre></span><pre>			sel_item = elm.selectedUnformattedItem()</pre></div>
<div class="nocov"><span class="num"><pre> 71</pre></span><pre>			if sel_item is not None:</pre></div>
<div class="nocov"><span class="num"><pre> 72</pre></span><pre>				items.append(sel_item)</pre></div>
<div class="nocov"><span class="num"><pre> 73</pre></span><pre>			else:</pre></div>
<div class="nocov"><span class="num"><pre> 74</pre></span><pre>				break</pre></div>
<div class="skip"><span class="num"><pre> 75</pre></span><pre>		# END for each element</pre></div>
<div class="skip"><span class="num"><pre> 76</pre></span><pre>		</pre></div>
<div class="nocov"><span class="num"><pre> 77</pre></span><pre>		url = &quot;/&quot;.join(items) or None</pre></div>
<div class="nocov"><span class="num"><pre> 78</pre></span><pre>		if absolute and url is not None:</pre></div>
<div class="nocov"><span class="num"><pre> 79</pre></span><pre>			url = concat_url(self.provider().root(), url)</pre></div>
<div class="skip"><span class="num"><pre> 80</pre></span><pre>		# END handle absolute urls</pre></div>
<div class="nocov"><span class="num"><pre> 81</pre></span><pre>		return url</pre></div>
<div class="skip"><span class="num"><pre> 82</pre></span><pre>		</pre></div>
<div class="cov"><span class="num"><pre> 83</pre></span><pre>	def numUrlElements(self):</pre></div>
<div class="cov"><span class="num"><pre> 84</pre></span><pre>		&quot;&quot;&quot;:return: number of url elements that are currently shown. A url of 1/2 would</pre></div>
<div class="cov"><span class="num"><pre> 85</pre></span><pre>		have two url elements&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre> 86</pre></span><pre>		return len(tuple(c for c in self._form.listChildren() if c.p_manage))</pre></div>
<div class="skip"><span class="num"><pre> 87</pre></span><pre>		</pre></div>
<div class="cov"><span class="num"><pre> 88</pre></span><pre>	def selectedUrlItemByIndex(self, index):</pre></div>
<div class="cov"><span class="num"><pre> 89</pre></span><pre>		&quot;&quot;&quot;:return: The selected url item at the given element index or None if nothing </pre></div>
<div class="cov"><span class="num"><pre> 90</pre></span><pre>			is selected</pre></div>
<div class="cov"><span class="num"><pre> 91</pre></span><pre>		:param index: 0 to numUrlElements()-1</pre></div>
<div class="cov"><span class="num"><pre> 92</pre></span><pre>		:raies IndexError:&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre> 93</pre></span><pre>		return self._form.listChildren()[index].selectedUnformattedItem()</pre></div>
<div class="skip"><span class="num"><pre> 94</pre></span><pre>		</pre></div>
<div class="cov"><span class="num"><pre> 95</pre></span><pre>	def urlItemsByIndex(self, index):</pre></div>
<div class="cov"><span class="num"><pre> 96</pre></span><pre>		&quot;&quot;&quot;:return: list of item ids which are currently being shown</pre></div>
<div class="cov"><span class="num"><pre> 97</pre></span><pre>		:param index: 0 based element index to numUrlElements()-1</pre></div>
<div class="cov"><span class="num"><pre> 98</pre></span><pre>		:raise IndexError:&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre> 99</pre></span><pre>		return list(self._form.listChildren()[index].base_items) </pre></div>
<div class="skip"><span class="num"><pre>100</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre>101</pre></span><pre>	</pre></div>
<div class="skip"><span class="num"><pre>102</pre></span><pre>	#} END Query</pre></div>
<div class="skip"><span class="num"><pre>103</pre></span><pre>	</pre></div>
<div class="skip"><span class="num"><pre>104</pre></span><pre>	#{ Edit</pre></div>
<div class="skip"><span class="num"><pre>105</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre>106</pre></span><pre>	def setFilter(self, filter=None):</pre></div>
<div class="cov"><span class="num"><pre>107</pre></span><pre>		&quot;&quot;&quot;Set or unset a filter. All items will be sent through the filter, and will</pre></div>
<div class="cov"><span class="num"><pre>108</pre></span><pre>		be shown only if they pass.</pre></div>
<div class="cov"><span class="num"><pre>109</pre></span><pre>		:param filter: Functor called f(url,t) and returns True for each item which may</pre></div>
<div class="cov"><span class="num"><pre>110</pre></span><pre>			be shown in the Finder. The url is the full relative url leading to, but </pre></div>
<div class="cov"><span class="num"><pre>111</pre></span><pre>			excluding the item t, whose visibility is being decided upon&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre>112</pre></span><pre>		self._filter = filter</pre></div>
<div class="skip"><span class="num"><pre>113</pre></span><pre>		</pre></div>
<div class="cov"><span class="num"><pre>114</pre></span><pre>	def setProvider(self, provider=None):</pre></div>
<div class="cov"><span class="num"><pre>115</pre></span><pre>		&quot;&quot;&quot;Set the provider to use</pre></div>
<div class="cov"><span class="num"><pre>116</pre></span><pre>		:param provider: ``iFinderProvider`` compatible instance, or None</pre></div>
<div class="cov"><span class="num"><pre>117</pre></span><pre>			If no provider is set, the instance will be blank&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre>118</pre></span><pre>		if self._provider is provider:</pre></div>
<div class="nocov"><span class="num"><pre>119</pre></span><pre>			return</pre></div>
<div class="skip"><span class="num"><pre>120</pre></span><pre>		# END early bailout</pre></div>
<div class="nocov"><span class="num"><pre>121</pre></span><pre>		self._provider = provider</pre></div>
<div class="skip"><span class="num"><pre>122</pre></span><pre>		</pre></div>
<div class="nocov"><span class="num"><pre>123</pre></span><pre>		if provider is not None:</pre></div>
<div class="nocov"><span class="num"><pre>124</pre></span><pre>			self._set_element_visible(0)</pre></div>
<div class="skip"><span class="num"><pre>125</pre></span><pre>		# END handle initial setup</pre></div>
<div class="skip"><span class="num"><pre>126</pre></span><pre>		</pre></div>
<div class="nocov"><span class="num"><pre>127</pre></span><pre>		self.selection_changed.send()</pre></div>
<div class="nocov"><span class="num"><pre>128</pre></span><pre>		self.url_changed.send(self.selectedUrl())</pre></div>
<div class="skip"><span class="num"><pre>129</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre>130</pre></span><pre>	def _set_item_by_index(self, elm, index, item):</pre></div>
<div class="nocov"><span class="num"><pre>131</pre></span><pre>		self._set_element_visible(index)</pre></div>
<div class="nocov"><span class="num"><pre>132</pre></span><pre>		elm.selectUnformattedItem(item)</pre></div>
<div class="nocov"><span class="num"><pre>133</pre></span><pre>		self.provider().storeUrlItem(index, item)</pre></div>
<div class="nocov"><span class="num"><pre>134</pre></span><pre>		self._set_element_visible(index+1)</pre></div>
<div class="skip"><span class="num"><pre>135</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre>136</pre></span><pre>	def setItemByIndex(self, item, index):</pre></div>
<div class="cov"><span class="num"><pre>137</pre></span><pre>		&quot;&quot;&quot;Set the given string item, which sits at the given index of a url</pre></div>
<div class="cov"><span class="num"><pre>138</pre></span><pre>		:raise ValueError: if item does not exist at given index</pre></div>
<div class="cov"><span class="num"><pre>139</pre></span><pre>		:raise IndexError: if index is not currently shown&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre>140</pre></span><pre>		assert self.provider() is not None, &quot;Provider is not set&quot;</pre></div>
<div class="nocov"><span class="num"><pre>141</pre></span><pre>		elm = self._form.listChildren()[index]</pre></div>
<div class="nocov"><span class="num"><pre>142</pre></span><pre>		if elm.selectedUnformattedItem() == item:</pre></div>
<div class="nocov"><span class="num"><pre>143</pre></span><pre>			return</pre></div>
<div class="skip"><span class="num"><pre>144</pre></span><pre>		# END early abort if nothing changes</pre></div>
<div class="nocov"><span class="num"><pre>145</pre></span><pre>		self._set_item_by_index(elm, index, item)</pre></div>
<div class="skip"><span class="num"><pre>146</pre></span><pre>		</pre></div>
<div class="nocov"><span class="num"><pre>147</pre></span><pre>		self.selection_changed.send()</pre></div>
<div class="nocov"><span class="num"><pre>148</pre></span><pre>		self.url_changed.send(self.selectedUrl())</pre></div>
<div class="skip"><span class="num"><pre>149</pre></span><pre>		</pre></div>
<div class="cov"><span class="num"><pre>150</pre></span><pre>	def setUrl(self, url, require_all_items=True, allow_memory=False):</pre></div>
<div class="cov"><span class="num"><pre>151</pre></span><pre>		&quot;&quot;&quot;Set the given url to be selected</pre></div>
<div class="cov"><span class="num"><pre>152</pre></span><pre>		:param url: / separated relative url. The individual items must be available</pre></div>
<div class="cov"><span class="num"><pre>153</pre></span><pre>			in the provider.</pre></div>
<div class="cov"><span class="num"><pre>154</pre></span><pre>		:parm require_all_items: if False, the control will display as many items as possible.</pre></div>
<div class="cov"><span class="num"><pre>155</pre></span><pre>			Otherwise it must display all given items, or raise ValueError</pre></div>
<div class="cov"><span class="num"><pre>156</pre></span><pre>		:param allow_memory: if true, provider memory may be used to show the longest chosen url, </pre></div>
<div class="cov"><span class="num"><pre>157</pre></span><pre>			being possibly more than you specify. Currently not implemented&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre>158</pre></span><pre>		assert self.provider() is not None, &quot;Provider is not set&quot;</pre></div>
<div class="nocov"><span class="num"><pre>159</pre></span><pre>		cur_url = self.selectedUrl()</pre></div>
<div class="nocov"><span class="num"><pre>160</pre></span><pre>		if cur_url == url:</pre></div>
<div class="nocov"><span class="num"><pre>161</pre></span><pre>			return</pre></div>
<div class="skip"><span class="num"><pre>162</pre></span><pre>		# END ignore similar urls</pre></div>
<div class="skip"><span class="num"><pre>163</pre></span><pre>		</pre></div>
<div class="nocov"><span class="num"><pre>164</pre></span><pre>		for eid, item in enumerate(url.split(&quot;/&quot;)):</pre></div>
<div class="nocov"><span class="num"><pre>165</pre></span><pre>			elm = self._form.listChildren()[eid]</pre></div>
<div class="nocov"><span class="num"><pre>166</pre></span><pre>			if elm.selectedUnformattedItem() == item:</pre></div>
<div class="nocov"><span class="num"><pre>167</pre></span><pre>				continue</pre></div>
<div class="skip"><span class="num"><pre>168</pre></span><pre>			# END skip items which already match</pre></div>
<div class="nocov"><span class="num"><pre>169</pre></span><pre>			try:</pre></div>
<div class="nocov"><span class="num"><pre>170</pre></span><pre>				self._set_item_by_index(elm, eid, item)</pre></div>
<div class="nocov"><span class="num"><pre>171</pre></span><pre>			except ValueError:</pre></div>
<div class="nocov"><span class="num"><pre>172</pre></span><pre>				if not require_all_items:</pre></div>
<div class="nocov"><span class="num"><pre>173</pre></span><pre>					break</pre></div>
<div class="skip"><span class="num"><pre>174</pre></span><pre>				# restore previous url</pre></div>
<div class="nocov"><span class="num"><pre>175</pre></span><pre>				self.setUrl(cur_url)</pre></div>
<div class="nocov"><span class="num"><pre>176</pre></span><pre>				raise</pre></div>
<div class="skip"><span class="num"><pre>177</pre></span><pre>			# END handle exceptions</pre></div>
<div class="skip"><span class="num"><pre>178</pre></span><pre>		# END for each item to set</pre></div>
<div class="skip"><span class="num"><pre>179</pre></span><pre>		</pre></div>
<div class="nocov"><span class="num"><pre>180</pre></span><pre>		self.selection_changed.send()</pre></div>
<div class="nocov"><span class="num"><pre>181</pre></span><pre>		self.url_changed.send(self.selectedUrl())</pre></div>
<div class="skip"><span class="num"><pre>182</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre>183</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre>184</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre>185</pre></span><pre>	#} END edit</pre></div>
<div class="skip"><span class="num"><pre>186</pre></span><pre>	</pre></div>
<div class="skip"><span class="num"><pre>187</pre></span><pre>	#{ Callbacks</pre></div>
<div class="skip"><span class="num"><pre>188</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre>189</pre></span><pre>	@logException</pre></div>
<div class="cov"><span class="num"><pre>190</pre></span><pre>	def _element_selection_changed(self, element, *args):</pre></div>
<div class="cov"><span class="num"><pre>191</pre></span><pre>		&quot;&quot;&quot;Called whenever any element changes its value, which forces the following </pre></div>
<div class="cov"><span class="num"><pre>192</pre></span><pre>		elements to refresh&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre>193</pre></span><pre>		index = self._index_by_item_element(element)</pre></div>
<div class="skip"><span class="num"><pre>194</pre></span><pre>		# store the currently selected item</pre></div>
<div class="nocov"><span class="num"><pre>195</pre></span><pre>		self.provider().storeUrlItem(index, element.selectedUnformattedItem())</pre></div>
<div class="nocov"><span class="num"><pre>196</pre></span><pre>		self._set_element_visible(index+1)</pre></div>
<div class="skip"><span class="num"><pre>197</pre></span><pre>		</pre></div>
<div class="nocov"><span class="num"><pre>198</pre></span><pre>		self.selection_changed.send()</pre></div>
<div class="nocov"><span class="num"><pre>199</pre></span><pre>		self.url_changed.send(self.selectedUrl())</pre></div>
<div class="skip"><span class="num"><pre>200</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre>201</pre></span><pre>	#} END callbacks</pre></div>
<div class="skip"><span class="num"><pre>202</pre></span><pre>	</pre></div>
<div class="skip"><span class="num"><pre>203</pre></span><pre>	#{ Utilities</pre></div>
<div class="skip"><span class="num"><pre>204</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre>205</pre></span><pre>	def _index_by_item_element(self, element):</pre></div>
<div class="cov"><span class="num"><pre>206</pre></span><pre>		&quot;&quot;&quot;:return: index matching the given item element, which must be one of our children&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre>207</pre></span><pre>		assert '|' in element</pre></div>
<div class="nocov"><span class="num"><pre>208</pre></span><pre>		for cid, c in enumerate(self._form.listChildren()):</pre></div>
<div class="nocov"><span class="num"><pre>209</pre></span><pre>			if c == element:</pre></div>
<div class="nocov"><span class="num"><pre>210</pre></span><pre>				return cid</pre></div>
<div class="skip"><span class="num"><pre>211</pre></span><pre>		# END for each child to enumerate</pre></div>
<div class="nocov"><span class="num"><pre>212</pre></span><pre>		raise ValueError(&quot;Didn't find element: %s&quot; % element)</pre></div>
<div class="skip"><span class="num"><pre>213</pre></span><pre>		</pre></div>
<div class="cov"><span class="num"><pre>214</pre></span><pre>	def _set_element_items(self, start_elm_id, elements ):</pre></div>
<div class="cov"><span class="num"><pre>215</pre></span><pre>		&quot;&quot;&quot;Fill the items from the start_elm_id throughout to all elements, until</pre></div>
<div class="cov"><span class="num"><pre>216</pre></span><pre>		one url does not yield any items, or the item cannot be selected </pre></div>
<div class="cov"><span class="num"><pre>217</pre></span><pre>		:param elements: a full list of all available child elements.&quot;&quot;&quot;</pre></div>
<div class="skip"><span class="num"><pre>218</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre>219</pre></span><pre>		# obtain the root url</pre></div>
<div class="nocov"><span class="num"><pre>220</pre></span><pre>		root_url = &quot;/&quot;.join(c.selectedUnformattedItem() for c in elements[:start_elm_id])</pre></div>
<div class="skip"><span class="num"><pre>221</pre></span><pre>		</pre></div>
<div class="nocov"><span class="num"><pre>222</pre></span><pre>		manage = True</pre></div>
<div class="nocov"><span class="num"><pre>223</pre></span><pre>		for elm_id in range(start_elm_id, len(elements)):</pre></div>
<div class="skip"><span class="num"><pre>224</pre></span><pre>				</pre></div>
<div class="skip"><span class="num"><pre>225</pre></span><pre>			# refill the items according to our provider</pre></div>
<div class="nocov"><span class="num"><pre>226</pre></span><pre>			elm = elements[elm_id]</pre></div>
<div class="nocov"><span class="num"><pre>227</pre></span><pre>			elm.p_manage=manage</pre></div>
<div class="skip"><span class="num"><pre>228</pre></span><pre>			</pre></div>
<div class="nocov"><span class="num"><pre>229</pre></span><pre>			if not manage:</pre></div>
<div class="nocov"><span class="num"><pre>230</pre></span><pre>				continue</pre></div>
<div class="skip"><span class="num"><pre>231</pre></span><pre>			# END abort if we just disable all others</pre></div>
<div class="skip"><span class="num"><pre>232</pre></span><pre>			</pre></div>
<div class="nocov"><span class="num"><pre>233</pre></span><pre>			items = self.provider().urlItems(root_url)</pre></div>
<div class="nocov"><span class="num"><pre>234</pre></span><pre>			elm.base_items = items</pre></div>
<div class="nocov"><span class="num"><pre>235</pre></span><pre>			if not items:</pre></div>
<div class="skip"><span class="num"><pre>236</pre></span><pre>				# keep one item visible, even though empty, if its the only one</pre></div>
<div class="nocov"><span class="num"><pre>237</pre></span><pre>				if len(elements) &gt; 1:</pre></div>
<div class="nocov"><span class="num"><pre>238</pre></span><pre>					elm.p_manage=False</pre></div>
<div class="nocov"><span class="num"><pre>239</pre></span><pre>				manage=False</pre></div>
<div class="nocov"><span class="num"><pre>240</pre></span><pre>				continue</pre></div>
<div class="skip"><span class="num"><pre>241</pre></span><pre>			# END skip on first empty url</pre></div>
<div class="skip"><span class="num"><pre>242</pre></span><pre>			</pre></div>
<div class="nocov"><span class="num"><pre>243</pre></span><pre>			if elm.p_numberOfItems:</pre></div>
<div class="nocov"><span class="num"><pre>244</pre></span><pre>				elm.p_removeAll = True</pre></div>
<div class="skip"><span class="num"><pre>245</pre></span><pre>			# END remove prior to re-append</pre></div>
<div class="skip"><span class="num"><pre>246</pre></span><pre>			</pre></div>
<div class="nocov"><span class="num"><pre>247</pre></span><pre>			for item in items:</pre></div>
<div class="nocov"><span class="num"><pre>248</pre></span><pre>				elm.p_append = self.provider().formatItem(root_url, elm_id, item)</pre></div>
<div class="skip"><span class="num"><pre>249</pre></span><pre>			# END for each item to append</pre></div>
<div class="skip"><span class="num"><pre>250</pre></span><pre>			</pre></div>
<div class="skip"><span class="num"><pre>251</pre></span><pre>			# try to reselect the previously selected item</pre></div>
<div class="nocov"><span class="num"><pre>252</pre></span><pre>			sel_item = self.provider().storedUrlItemByIndex(elm_id)</pre></div>
<div class="nocov"><span class="num"><pre>253</pre></span><pre>			if sel_item is None:</pre></div>
<div class="skip"><span class="num"><pre>254</pre></span><pre>				# make sure next item is not being shown</pre></div>
<div class="nocov"><span class="num"><pre>255</pre></span><pre>				manage=False</pre></div>
<div class="nocov"><span class="num"><pre>256</pre></span><pre>				continue</pre></div>
<div class="skip"><span class="num"><pre>257</pre></span><pre>			# END handle item memorization</pre></div>
<div class="skip"><span class="num"><pre>258</pre></span><pre>			</pre></div>
<div class="nocov"><span class="num"><pre>259</pre></span><pre>			try:</pre></div>
<div class="nocov"><span class="num"><pre>260</pre></span><pre>				elm.selectUnformattedItem(sel_item)</pre></div>
<div class="nocov"><span class="num"><pre>261</pre></span><pre>			except (RuntimeError, ValueError):</pre></div>
<div class="nocov"><span class="num"><pre>262</pre></span><pre>				manage=False</pre></div>
<div class="nocov"><span class="num"><pre>263</pre></span><pre>				continue</pre></div>
<div class="skip"><span class="num"><pre>264</pre></span><pre>			# END handle exception</pre></div>
<div class="skip"><span class="num"><pre>265</pre></span><pre>			</pre></div>
<div class="skip"><span class="num"><pre>266</pre></span><pre>			# update the root</pre></div>
<div class="nocov"><span class="num"><pre>267</pre></span><pre>			if root_url:</pre></div>
<div class="nocov"><span class="num"><pre>268</pre></span><pre>				root_url += &quot;/&quot;</pre></div>
<div class="skip"><span class="num"><pre>269</pre></span><pre>			# END assure / is not the first character</pre></div>
<div class="nocov"><span class="num"><pre>270</pre></span><pre>			root_url += sel_item</pre></div>
<div class="skip"><span class="num"><pre>271</pre></span><pre>		# END for each url to handle</pre></div>
<div class="skip"><span class="num"><pre>272</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre>273</pre></span><pre>	</pre></div>
<div class="cov"><span class="num"><pre>274</pre></span><pre>	def _set_element_visible(self, index):</pre></div>
<div class="cov"><span class="num"><pre>275</pre></span><pre>		&quot;&quot;&quot;Possibly create and fill the given element index, all following elements</pre></div>
<div class="cov"><span class="num"><pre>276</pre></span><pre>		are set invivisble&quot;&quot;&quot;</pre></div>
<div class="nocov"><span class="num"><pre>277</pre></span><pre>		children = self._form.listChildren()</pre></div>
<div class="skip"><span class="num"><pre>278</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre>279</pre></span><pre>		# create as many new scrollLists as required,</pre></div>
<div class="nocov"><span class="num"><pre>280</pre></span><pre>		elms_to_create = max(0, (index+1) - len(children))</pre></div>
<div class="nocov"><span class="num"><pre>281</pre></span><pre>		if elms_to_create:</pre></div>
<div class="nocov"><span class="num"><pre>282</pre></span><pre>			self._form.setActive()</pre></div>
<div class="nocov"><span class="num"><pre>283</pre></span><pre>			for i in range(elms_to_create):</pre></div>
<div class="skip"><span class="num"><pre>284</pre></span><pre>				# make sure we keep our array uptodate</pre></div>
<div class="nocov"><span class="num"><pre>285</pre></span><pre>				child = self._form.add(self.t_element(allowMultiSelection=False, font=&quot;smallFixedWidthFont&quot;))</pre></div>
<div class="nocov"><span class="num"><pre>286</pre></span><pre>				children.append(child)</pre></div>
<div class="skip"><span class="num"><pre>287</pre></span><pre>				</pre></div>
<div class="nocov"><span class="num"><pre>288</pre></span><pre>				child.e_selectCommand = self._element_selection_changed</pre></div>
<div class="skip"><span class="num"><pre>289</pre></span><pre>				</pre></div>
<div class="nocov"><span class="num"><pre>290</pre></span><pre>				t, b, l, r = self._form.kSides</pre></div>
<div class="nocov"><span class="num"><pre>291</pre></span><pre>				m = 2</pre></div>
<div class="skip"><span class="num"><pre>292</pre></span><pre>				</pre></div>
<div class="skip"><span class="num"><pre>293</pre></span><pre>				# they are always attached top+bottom</pre></div>
<div class="nocov"><span class="num"><pre>294</pre></span><pre>				self._form.setup(	attachForm=((child, t, m), (child, b, m)),</pre></div>
<div class="nocov"><span class="num"><pre>295</pre></span><pre>									attachNone=(child, r)	)</pre></div>
<div class="skip"><span class="num"><pre>296</pre></span><pre>				</pre></div>
<div class="skip"><span class="num"><pre>297</pre></span><pre>				# we generally keep the right side un-attached</pre></div>
<div class="nocov"><span class="num"><pre>298</pre></span><pre>				if len(children) == 1:</pre></div>
<div class="skip"><span class="num"><pre>299</pre></span><pre>					# first element goes left</pre></div>
<div class="nocov"><span class="num"><pre>300</pre></span><pre>					self._form.setup(attachForm=(child, l, m))</pre></div>
<div class="nocov"><span class="num"><pre>301</pre></span><pre>				else:</pre></div>
<div class="skip"><span class="num"><pre>302</pre></span><pre>					# all other elements attach to the right side</pre></div>
<div class="nocov"><span class="num"><pre>303</pre></span><pre>					self._form.setup(attachControl=(child, l, m, children[-2]))</pre></div>
<div class="skip"><span class="num"><pre>304</pre></span><pre>				# END handle amount of children</pre></div>
<div class="skip"><span class="num"><pre>305</pre></span><pre>				# children.append(child)</pre></div>
<div class="skip"><span class="num"><pre>306</pre></span><pre>			# END for each element to add</pre></div>
<div class="skip"><span class="num"><pre>307</pre></span><pre>		# END if elms to create</pre></div>
<div class="skip"><span class="num"><pre>308</pre></span><pre>		</pre></div>
<div class="nocov"><span class="num"><pre>309</pre></span><pre>		self._set_element_items(index, children)</pre></div>
<div class="skip"><span class="num"><pre>310</pre></span><pre>		</pre></div>
<div class="skip"><span class="num"><pre>311</pre></span><pre>	#} END utilities</pre></div>
<div class="skip"><span class="num"><pre>312</pre></span><pre></pre></div>
<div class="skip"><span class="num"><pre>313</pre></span><pre></pre></div>
</div>
</body>
</html>
